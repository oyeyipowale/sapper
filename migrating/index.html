<!doctype html> <html class="theme-default typo-default" lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#159794 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=prism.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <meta content=summary_large_image name=twitter:card> <meta content=@sveltejs name=twitter:site> <meta content=@sveltejs name=twitter:creator> <meta content=https://sapper.svelte.dev/images/twitter-card.png name=twitter:image> <meta content=https://svelte.dev/images/twitter-card.png name=og:image> <link href=client/main.3570290817.css rel=stylesheet><link href=client/client.141aceb2.css rel=stylesheet> <style>.hljs,.hljs-subst{color:#333}.hljs-comment{color:#999}.hljs-tag{color:#170}.hljs-keyword{color:#708}.hljs-attr{color:#333}.hljs-number{color:#164}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#105e10}.hljs-section,.hljs-title{color:#105e10}.hljs-literal{color:#170}.hljs-meta{color:#555}.hljs-meta-string{color:#555}</style> <title>Migration • Sapper</title><meta content="Sapper migration guides" name=twitter:title data-svelte=svelte-1a7q9uv><meta content="The next small thing in web development" name=twitter:description data-svelte=svelte-1a7q9uv><meta content="The next small thing in web development" name=Description data-svelte=svelte-1a7q9uv> <link href=/client/main.3570290817.css rel=preload as=style><link href=/client/client.141aceb2.css rel=preload as=style></head> <body> <div id=sapper> <div style=display:none> <svg><symbol class=icon id=arrow-left viewBox="0 0 24 24"><line x1=19 x2=5 y1=12 y2=12></line><polyline points="12 19 5 12 12 5"></polyline></symbol><symbol class=icon id=arrow-right viewBox="0 0 24 24"><line x1=5 x2=19 y1=12 y2=12></line><polyline points="12 5 19 12 12 19"></polyline></symbol><symbol class=icon id=arrow-up viewBox="0 0 24 24"><line x1=12 x2=12 y1=19 y2=5></line><polyline points="5 12 12 5 19 12"></polyline></symbol><symbol class=icon id=arrow-down viewBox="0 0 24 24"><line x1=12 x2=12 y1=5 y2=19></line><polyline points="19 12 12 19 5 12"></polyline></symbol><symbol class=icon id=check viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></symbol><symbol class=icon id=close viewBox="0 0 24 24"><line x1=18 x2=6 y1=6 y2=18></line><line x1=6 x2=18 y1=6 y2=18></line></symbol><symbol class=icon id=download viewBox="0 0 24 24"><path d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15"></path><polyline points="7 10 12 15 17 10"></polyline><line x1=12 x2=12 y1=15 y2=3></line></symbol><symbol class=icon id=edit viewBox="0 0 24 24"><path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon></symbol><symbol class=icon id=github viewBox="0 0 24 24"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></symbol><symbol class=icon id=git-branch viewBox="0 0 24 24"><line x1=6 x2=6 y1=3 y2=15></line><circle cx=18 cy=6 r=3></circle><circle cx=6 cy=18 r=3></circle><path d="M18 9a9 9 0 0 1-9 9"></path></symbol><symbol class=icon id=log-in viewBox="0 0 24 24"><path d="M15 3H19A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H15"></path><polyline points="10 17 15 12 10 7"></polyline><line x1=15 x2=3 y1=12 y2=12></line></symbol><symbol class=icon id=maximize viewBox="0 0 24 24"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></symbol><symbol class=icon id=maximize-2 viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1=21 x2=14 y1=3 y2=10></line><line x1=3 x2=10 y1=21 y2=14></line></symbol><symbol class=icon id=menu viewBox="0 0 24 24"><line x1=3 x2=21 y1=12 y2=12></line><line x1=3 x2=21 y1=6 y2=6></line><line x1=3 x2=21 y1=18 y2=18></line></symbol><symbol class=icon id=message-square viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></symbol><symbol class=icon id=minus viewBox="0 0 24 24"><line x1=5 x2=19 y1=12 y2=12></line></symbol><symbol class=icon id=plus viewBox="0 0 24 24"><line x1=12 x2=12 y1=5 y2=19></line><line x1=5 x2=19 y1=12 y2=12></line></symbol><symbol class=icon id=save viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></symbol><symbol class=icon id=link viewBox="0 0 24 24"><path d="M9,7L6,7A2 2 0 0 0 6,17L9,17"></path><path d="M15,7L18,7A2 2 0 0 1 18,17L15,17"></path><path d=M7,12L17,12></path></symbol><symbol class=icon id=chevron viewBox="0 0 24 24"><path d="M2,7 L12,17 L20,7"></path></symbol></svg></div> <header class="svelte-1txnqye visible"><nav class=svelte-1txnqye><a href=. class="svelte-1txnqye home" rel=prefetch style=background-image:url(sapper-logo-horizontal.svg) title=Homepage>Home</a> <ul class="svelte-1txnqye primary"><li class="svelte-1txnqye hide-if-desktop"><a href=. class=svelte-1txnqye rel=prefetch>Home</a></li> <li><a href=docs rel=prefetch>Docs</a></li> <li><a href=faq rel=prefetch>FAQ</a></li> <li><a href=https://svelte.dev>Svelte</a></li> <li><a href=https://svelte.dev/chat title="Discord Chat"> <svg class="icon svelte-5yec89" height=20 width=20><use xlink:href=#message-square></use></svg></a></li> <li><a href=https://github.com/sveltejs/sapper title="GitHub Repo"> <svg class="icon svelte-5yec89" height=20 width=20><use xlink:href=#github></use></svg></a></ul></nav></header> <main class=svelte-d6kcga> <div class="svelte-1itkhys content listify"><section class=svelte-1itkhys data-id=Migrating><h2 class=svelte-1itkhys><span class=offset-anchor id=Migrating></span> <a href=migrating#Migrating class=anchor aria-hidden></a> Migrating <small class=svelte-1itkhys><a href=https://github.com/sveltejs/sapper/edit/master/site/content/migrating/01-migrating.md class=svelte-1itkhys title="edit this section"> <svg class="icon svelte-5yec89" height=20 width=20><use xlink:href=#edit></use></svg></a> </small></h2> <p>Until we reach version 1.0, there may be occasional changes to the project structure Sapper expects.</p> <h3> <span class=offset-anchor id=0_27_to_0_28></span> <a href=migrating#0_27_to_0_28 class=anchor aria-hidden=true></a> 0.27 to 0.28 </h3><ul> <li>Rollup 0.x.x is no longer supported. (<a href=https://github.com/sveltejs/sapper/pull/1326 rel="noopener noreferrer" target=_blank>#1326</a>). Any version greater than 1.x is supported, but the latest (currently 2.x) is strongly recommended.</li> <li>Versions of Svelte before 3.17.3 are no longer supported. (<a href=https://github.com/sveltejs/sapper/pull/1067 rel="noopener noreferrer" target=_blank>#1067</a>)</li> <li><code>&lt;script></code> tags will now be loaded with the <code>defer</code> attribute (<a href=https://github.com/sveltejs/sapper/pull/1123 rel="noopener noreferrer" target=_blank>#1123</a>), which means:<ul> <li>IE9 support was dropped since IE9 may interleave deferred script execution.</li> <li><code>%sapper.scripts%</code> can be moved to the <code>&lt;head></code> section for slightly better performance</li> </ul> </li> <li>You must set <code>hydratable: true</code> in your server build as well in order to properly hydrate <code>&lt;head></code> elements (<a href=https://github.com/sveltejs/sapper/pull/1067 rel="noopener noreferrer" target=_blank>#1067</a>)</li> <li>The files in the generated <code>service-worker.js</code> file are now prefixed with a <code>/</code> (<a href=https://github.com/sveltejs/sapper/pull/1244 rel="noopener noreferrer" target=_blank>#1244</a>). If you are using the <code>service-worker.js</code> from the default template, no changes will be necessary. If you have modified your service worker, please check to ensure compatibility.</li> <li>The <code>sapper-noscroll</code> attribute was renamed to <code>sapper:noscroll</code> (<a href=https://github.com/sveltejs/sapper/pull/1320 rel="noopener noreferrer" target=_blank>#1320</a>)</li> <li>Rollup users should update the <code>onwarn</code> filter in <code>rollup.config.js</code> to match <a href=https://github.com/sveltejs/sapper-template/pull/246/files rel="noopener noreferrer" target=_blank>the change made in <code>sapper-template</code></a>. </li> </ul> <h3> <span class=offset-anchor id=0_25_to_0_26></span> <a href=migrating#0_25_to_0_26 class=anchor aria-hidden=true></a> 0.25 to 0.26 </h3><p>The most significant change yet: Sapper is now built on Svelte 3.</p> <h4> <span class=offset-anchor id=Importing_Sapper></span> <a href=migrating#Importing_Sapper class=anchor aria-hidden=true></a> Importing Sapper </h4><p>Your app's runtime is now built to <code>src/node_modules/@sapper</code> — this allows you to easily import it from anywhere in your source code. Update your <code>server.js</code>...</p> <div class=""><pre class=language-diff><code>// src/server.js
<span class=hljs-deletion>-import * as sapper from '../__sapper__/server.js';</span>
<span class=hljs-addition>+import * as sapper from '@sapper/server';</span></code></pre></div><p>...and client.js:</p> <div class=""><pre class=language-diff><code><span class=hljs-deletion>-import * as sapper from '../__sapper__/client.js';</span>
<span class=hljs-addition>+import * as sapper from '@sapper/app';</span>

sapper.start({
	target: document.querySelector('#sapper')
});</code></pre></div><p>The same applies to imports like <code>goto</code> and <code>prefetchRoutes</code>.</p> <h4> <span class=offset-anchor id=Webpack_config></span> <a href=migrating#Webpack_config class=anchor aria-hidden=true></a> Webpack config </h4><p>If you're using webpack, you must update your configuration to recognise <code>.mjs</code> and <code>.svelte</code> files:</p> <div class=""><pre class=language-javascript><code>resolve: {
	<span class=hljs-attr>extensions</span>: [<span class=hljs-string>'.mjs'</span>, <span class=hljs-string>'.js'</span>, <span class=hljs-string>'.json'</span>, <span class=hljs-string>'.svelte'</span>, <span class=hljs-string>'.html'</span>]
}</code></pre></div><p>If you're using .svelte files (recommended), you'll also need to tell <code>svelte-loader</code> to expect them:</p> <div class=""><pre class=language-diff><code><span class=hljs-deletion>-test: /\.html$/</span>
<span class=hljs-addition>+test: /\.(svelte|html)$/</span></code></pre></div> <h4> <span class=offset-anchor id=Session_data></span> <a href=migrating#Session_data class=anchor aria-hidden=true></a> Session data </h4><p>Passing data from server to client is now accomplished with a <code>session</code> function passed to the middleware:</p> <div class=""><pre class=language-javascript><code><span class=hljs-comment>// src/server.js</span>
sapper.middleware({
	<span class=hljs-attr>session</span>: <span class=hljs-function>(<span class=hljs-params>req, res</span>) =></span> ({
		<span class=hljs-comment>// session data goes here</span>
	})
})</code></pre></div><p>This data is available in <code>preload</code> functions as the second argument:</p> <div class=""><pre class=language-markup><code><span class=hljs-comment>&lt;!-- SomeComponent.svelte --></span>
<span class=hljs-tag>&lt;<span class=hljs-name>script</span> <span class=hljs-attr>context</span>=<span class=hljs-string>"module"</span>></span><span class=javascript>
	<span class=hljs-keyword>export</span> <span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>preload</span>(<span class=hljs-params>page, session</span>) </span>{
		<span class=hljs-keyword>const</span> { path, params, query } = page; <span class=hljs-comment>// as before</span>

		<span class=hljs-keyword>if</span> (!session.user) <span class=hljs-keyword>return</span> <span class=hljs-keyword>this</span>.redirect(<span class=hljs-number>302</span>, <span class=hljs-string>'login'</span>);
		<span class=hljs-comment>// ...</span>
	}
</span><span class=hljs-tag>&lt;/<span class=hljs-name>script</span>></span></code></pre></div> <h4> <span class=offset-anchor id=Stores></span> <a href=migrating#Stores class=anchor aria-hidden=true></a> Stores </h4><p>It is also available, along with <code>page</code> and <code>preloading</code>, as a store inside components:</p> <div class=""><pre class=language-markup><code><span class=hljs-tag>&lt;<span class=hljs-name>script</span>></span><span class=javascript>
	<span class=hljs-keyword>import</span> * <span class=hljs-keyword>as</span> sapper <span class=hljs-keyword>from</span> <span class=hljs-string>'@sapper/app'</span>;
	<span class=hljs-keyword>const</span> { page, preloading, session } = sapper.stores();
</span><span class=hljs-tag>&lt;/<span class=hljs-name>script</span>></span></code></pre></div><p><code>page</code> and <code>preloading</code> are <a href=https://svelte.dev/tutorial/readable-stores rel="noopener noreferrer" target=_blank>readable stores</a>, while <code>session</code> is <a href=https://svelte.dev/tutorial/writable-stores rel="noopener noreferrer" target=_blank>writable</a>. Writing to the session store (for example, after the user logs in) will cause any <code>preload</code> functions that rely on session data to re-run; it will not persist anything to the server.</p> <h4> <span class=offset-anchor id=Layouts></span> <a href=migrating#Layouts class=anchor aria-hidden=true></a> Layouts </h4><p>Your layout components should now use a <code>&lt;slot></code> element to render nested routes, instead of <code>&lt;svelte:component></code>:</p> <div class=""><pre class=language-diff><code>&lt;main>
<span class=hljs-deletion>-    &lt;svelte:component this={child.component} {...child.props}/></span>
<span class=hljs-addition>+    &lt;slot>&lt;/slot></span>
&lt;/main></code></pre></div><p>The layout component itself receives a <code>segment</code> prop, which is equivalent to <code>child.segment</code> in earlier versions.</p> <h3> <span class=offset-anchor id=0_21_to_0_22></span> <a href=migrating#0_21_to_0_22 class=anchor aria-hidden=true></a> 0.21 to 0.22 </h3><p>Instead of importing middleware from the <code>sapper</code> package, or importing the client runtime from <code>sapper/runtime.js</code>, the app is <em>compiled into</em> the generated files:</p> <div class=""><pre class=language-diff><code>// src/client.js
<span class=hljs-deletion>-import { init } from 'sapper/runtime.js';</span>
<span class=hljs-deletion>-import { manifest } from './manifest/client.js';</span>
<span class=hljs-addition>+import * as sapper from '../__sapper__/client.js';</span>

<span class=hljs-deletion>-init({</span>
<span class=hljs-addition>+sapper.start({</span>
	target: document.querySelector('#sapper'),
<span class=hljs-deletion>-    manifest</span>
});</code></pre></div><div class=""><pre class=language-diff><code>// src/server.js
import sirv from 'sirv';
import polka from 'polka';
import compression from 'compression';
<span class=hljs-deletion>-import sapper from 'sapper';</span>
<span class=hljs-deletion>-import { manifest } from './manifest/server.js';</span>
<span class=hljs-addition>+import * as sapper from '../__sapper__/server.js';</span>

const { PORT, NODE_ENV } = process.env;
const dev = NODE_ENV <span class=hljs-comment>=== 'development';</span>

polka() // You can also use Express
	.use(
		compression({ threshold: 0 }),
<span class=hljs-deletion>-        sirv('assets', { dev }),</span>
<span class=hljs-addition>+        sirv('static', { dev }),</span>
<span class=hljs-deletion>-        sapper({ manifest })</span>
<span class=hljs-addition>+        sapper.middleware()</span>
	)
	.listen(PORT, err => {
		if (err) console.log('error', err);
	});</code></pre></div><div class=""><pre class=language-diff><code>// src/service-worker.js
<span class=hljs-deletion>-import { assets, shell, routes, timestamp } from './manifest/service-worker.js';</span>
<span class=hljs-addition>+import { files, shell, routes, timestamp } from '../__sapper__/service-worker.js';</span></code></pre></div><p>In addition, the default build and export directories are now <code>__sapper__/build</code> and <code>__sapper__/export</code> respectively.</p> <h3> <span class=offset-anchor id=0_20_to_0_21></span> <a href=migrating#0_20_to_0_21 class=anchor aria-hidden=true></a> 0.20 to 0.21 </h3><ul> <li>The <code>app</code> directory is now <code>src</code></li> <li>The <code>routes</code> directory is now <code>src/routes</code></li> <li>The <code>assets</code> directory is now <code>static</code> (remember to update your <code>src/server.js</code> file to reflect this change as well)</li> <li>Instead of having three separate config files (<code>webpack/client.config.js</code>, <code>webpack/server.config.js</code> and <code>webpack/service-worker.config.js</code>), there is a single <code>webpack.config.js</code> file that exports <code>client</code>, <code>server</code> and <code>serviceworker</code> configs.</li> </ul> <h3> <span class=offset-anchor id=0_17_to_0_18></span> <a href=migrating#0_17_to_0_18 class=anchor aria-hidden=true></a> 0.17 to 0.18 </h3><p>The <code>sapper/webpack/config.js</code> file (required in the <code>webpack/*.config.js</code> files) is now <code>sapper/config/webpack.js</code>.</p> <h3> <span class=offset-anchor id=0_14_to_0_15></span> <a href=migrating#0_14_to_0_15 class=anchor aria-hidden=true></a> 0.14 to 0.15 </h3><p>This release changed how routing is handled, resulting in a number of changes.</p> <p>Instead of a single <code>App.html</code> component, you can place <code>_layout.html</code> components in any directory under <code>routes</code>. You should move <code>app/App.html</code> to <code>routes/_layout.html</code> and modify it like so:</p> <div class=""><pre class=language-diff><code><span class=hljs-deletion>-&lt;!-- app/App.html --></span>
<span class=hljs-addition>+&lt;!-- routes/_layout.html --></span>

<span class=hljs-deletion>-&lt;Nav path={props.path}/></span>
<span class=hljs-addition>+&lt;Nav segment={child.segment}/></span>

<span class=hljs-deletion>-&lt;svelte:component this={Page} {...props}/></span>
<span class=hljs-addition>+&lt;svelte:component this={child.component} {...child.props}/></span></code></pre></div><p>You will then need to remove <code>App</code> from your client and server entry points, and replace <code>routes</code> with <code>manifest</code>:</p> <div class=""><pre class=language-diff><code>// app/client.js
import { init } from 'sapper/runtime.js';
<span class=hljs-deletion>-import { routes } from './manifest/client.js';</span>
<span class=hljs-deletion>-import App from './App.html';</span>
<span class=hljs-addition>+import { manifest } from './manifest/client.js';</span>

init({
	target: document.querySelector('#sapper'),
<span class=hljs-deletion>-    routes,</span>
<span class=hljs-deletion>-    App</span>
<span class=hljs-addition>+    manifest</span>
});</code></pre></div><div class=""><pre class=language-diff><code>// app/server.js
import sirv from 'sirv';
import polka from 'polka';
import sapper from 'sapper';
import compression from 'compression';
<span class=hljs-deletion>-import { routes } from './manifest/server.js';</span>
<span class=hljs-deletion>-import App from './App.html';</span>
<span class=hljs-addition>+import { manifest } from './manifest/server.js';</span>

polka()
	.use(
		compression({ threshold: 0 }),
		sirv('assets'),
<span class=hljs-deletion>-        sapper({ routes, App })</span>
<span class=hljs-addition>+        sapper({ manifest })</span>
	)
	.listen(process.env.PORT)
	.catch(err => {
		console.log('error', err);
	});</code></pre></div><p><code>preload</code> functions no longer take the entire request object on the server; instead, they receive the same argument as on the client.</p> <h3> <span class=offset-anchor id=0_13_to_0_14></span> <a href=migrating#0_13_to_0_14 class=anchor aria-hidden=true></a> 0.13 to 0.14 </h3><p>The <code>4xx.html</code> and <code>5xx.html</code> error pages have been replaced with a single page, <code>_error.html</code>. In addition to the regular <code>params</code>, <code>query</code> and <code>path</code> props, it receives <code>status</code> and <code>error</code>.</p> <h3> <span class=offset-anchor id=0_11_to_0_12></span> <a href=migrating#0_11_to_0_12 class=anchor aria-hidden=true></a> 0.11 to 0.12 </h3><p>In earlier versions, each page was a completely standalone component. Upon navigation, the entire page would be torn down and a new one created. Typically, each page would import a shared <code>&lt;Layout></code> component to achieve visual consistency.</p> <p>As of 0.12, this changes: we have a single <code>&lt;App></code> component, defined in <code>app/App.html</code>, which controls the rendering of the rest of the app. See <a href=https://github.com/sveltejs/sapper-template/blob/master/app/App.html rel="noopener noreferrer" target=_blank>sapper-template</a> for an example.</p> <p>This component is rendered with the following values:</p> <ul> <li><code>Page</code> — a component constructor for the current page</li> <li><code>props</code> — an object with <code>params</code>, <code>query</code>, and any data returned from the page's <code>preload</code> function</li> <li><code>preloading</code> — <code>true</code> during preload, <code>false</code> otherwise. Useful for showing progress indicators</li> </ul> <p>Sapper needs to know about your app component. To that end, you will need to modify your <code>app/server.js</code> and <code>app/client.js</code>:</p> <div class=""><pre class=language-diff><code>// app/server.js
import polka from 'polka';
import sapper from 'sapper';
import serve from 'serve-static';
import { routes } from './manifest/server.js';
<span class=hljs-addition>+import App from './App.html';</span>

polka()
	.use(
		serve('assets'),
<span class=hljs-deletion>-        sapper({ routes })</span>
<span class=hljs-addition>+        sapper({ App, routes })</span>
	)
	.listen(process.env.PORT);</code></pre></div><div class=""><pre class=language-diff><code>// app/client.js
import { init } from 'sapper/runtime.js';
import { routes } from './manifest/client.js';
<span class=hljs-addition>+import App from './App.html';</span>

<span class=hljs-deletion>-init(target: document.querySelector('#sapper'), routes);</span>
<span class=hljs-addition>+init({</span>
<span class=hljs-addition>+    target: document.querySelector('#sapper'),</span>
<span class=hljs-addition>+    routes,</span>
<span class=hljs-addition>+    App</span>
<span class=hljs-addition>+});</span></code></pre></div><p>Once your <code>App.html</code> has been created and your server and client apps updated, you can remove any <code>&lt;Layout></code> components from your individual pages.</p> <h3> <span class=offset-anchor id=0_9_to_0_10></span> <a href=migrating#0_9_to_0_10 class=anchor aria-hidden=true></a> &lt;0.9 to 0.10 </h3> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> app/template.html </h5><ul> <li>Your <code>&lt;head></code> element must contain <code>%sapper.base%</code> (see (<a href=docs#Base_URLs rel="noopener noreferrer">base URLs</a>)</li> <li>Remove references to your service worker; this is now handled by <code>%sapper.scripts%</code></li> </ul> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> Pages </h5><ul> <li>Your <code>preload</code> functions should now use <code>this.fetch</code> instead of <code>fetch</code>. <code>this.fetch</code> allows you to make credentialled requests on the server, and means that you no longer need to create a <code>global.fetch</code> object in <code>app/server.js</code>.</li> </ul> <h3> <span class=offset-anchor id=0_6_to_0_7></span> <a href=migrating#0_6_to_0_7 class=anchor aria-hidden=true></a> 0.6 to 0.7 </h3><p>Consult <a href=https://github.com/sveltejs/sapper-template rel="noopener noreferrer" target=_blank>sapper-template</a> for full examples of all the below points.</p> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> package.json </h5><p>To start a dev server, use <code>sapper dev</code> rather than <code>node server.js</code>. In all likelihood, your package.json will have an <code>npm run dev</code> script that will need to be updated.</p> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> Entry points </h5><p>As of version 0.7, Sapper expects to find your entry points — for client, server and service worker — in an <code>app</code> folder. Instead of using magically-injected <code>__variables__</code>, each entry point imports from its corresponding file in the <code>app/manifests</code> folder. These are automatically generated by Sapper.</p> <div class=""><pre class=language-javascript><code><span class=hljs-comment>// app/client.js (formerly templates/main.js)</span>
<span class=hljs-keyword>import</span> { init } <span class=hljs-keyword>from</span> <span class=hljs-string>'sapper/runtime.js'</span>;
<span class=hljs-keyword>import</span> { routes } <span class=hljs-keyword>from</span> <span class=hljs-string>'./manifest/client.js'</span>;

init(<span class=hljs-built_in>document</span>.querySelector(<span class=hljs-string>'#sapper'</span>), routes);

<span class=hljs-keyword>if</span> (<span class=hljs-built_in>module</span>.hot) <span class=hljs-built_in>module</span>.hot.accept(); <span class=hljs-comment>// enable hot reloading</span></code></pre></div><div class=""><pre class=language-javascript><code><span class=hljs-comment>// app/server.js (formerly server.js)</span>
<span class=hljs-comment>// Note that we're now using ES module syntax, because this</span>
<span class=hljs-comment>// file is processed by webpack like the rest of your app</span>
<span class=hljs-keyword>import</span> sapper <span class=hljs-keyword>from</span> <span class=hljs-string>'sapper'</span>;
<span class=hljs-keyword>import</span> { routes } <span class=hljs-keyword>from</span> <span class=hljs-string>'./manifest/server.js'</span>;
<span class=hljs-comment>// ..other imports</span>

<span class=hljs-comment>// we now pass the `routes` object to the Sapper middleware</span>
app.use(sapper({
	routes
}));</code></pre></div><div class=""><pre class=language-javascript><code><span class=hljs-comment>// app/service-worker.js (formerly templates/service-worker.js)</span>
<span class=hljs-keyword>import</span> { assets, shell, timestamp, routes } <span class=hljs-keyword>from</span> <span class=hljs-string>'./manifest/service-worker.js'</span>;

<span class=hljs-comment>// replace e.g. `__assets__` with `assets` in the rest of the file</span></code></pre></div> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> Templates and error pages </h5><p>In previous versions, we had <code>templates/2xx.html</code>, <code>templates/4xx.html</code> and <code>templates/5xx.html</code>. Now, we have a single template, <code>app/template.html</code>, which should look like your old <code>templates/2xx.html</code>.</p> <p>For handling error states, we have a 'special' route: <code>routes/_error.html</code>.</p> <p>This page is just like any other, except that it will get rendered whenever an error states is reached. The component has access to <code>status</code> and <code>error</code> values.</p> <p>Note that you can now use <code>this.error(statusCode, error)</code> inside your <code>preload</code> functions.</p> <h5> <span class=offset-anchor id=false data-scrollignore></span> <a href=migrating#false class=anchor aria-hidden=true></a> Webpack configs </h5><p>Your webpack configs now live in a <code>webpack</code> directory:</p> <ul> <li><code>webpack.client.config.js</code> is now <code>webpack/client.config.js</code></li> <li><code>webpack.server.config.js</code> is now <code>webpack/server.config.js</code></li> </ul> <p>If you have a service worker, you should also have a <code>webpack/service-worker.config.js</code> file. See <a href=https://github.com/sveltejs/sapper-template rel="noopener noreferrer" target=_blank>sapper-template</a> for an example.</p> </section></div> <aside class="svelte-1itkhys sidebar-container"><div class="svelte-1itkhys sidebar"> <ul class="svelte-mm3tjv reference-toc"><li class=svelte-mm3tjv><a href=migrating#Migrating class="svelte-mm3tjv section">Migrating </a> <a href=migrating#0_27_to_0_28 class="svelte-mm3tjv subsection" data-level=3>0.27 to 0.28 </a> <a href=migrating#0_25_to_0_26 class="svelte-mm3tjv subsection" data-level=3>0.25 to 0.26 </a> <a href=migrating#Importing_Sapper class="svelte-mm3tjv subsection" data-level=4>Importing Sapper </a> <a href=migrating#Webpack_config class="svelte-mm3tjv subsection" data-level=4>Webpack config </a> <a href=migrating#Session_data class="svelte-mm3tjv subsection" data-level=4>Session data </a> <a href=migrating#Stores class="svelte-mm3tjv subsection" data-level=4>Stores </a> <a href=migrating#Layouts class="svelte-mm3tjv subsection" data-level=4>Layouts </a> <a href=migrating#0_21_to_0_22 class="svelte-mm3tjv subsection" data-level=3>0.21 to 0.22 </a> <a href=migrating#0_20_to_0_21 class="svelte-mm3tjv subsection" data-level=3>0.20 to 0.21 </a> <a href=migrating#0_17_to_0_18 class="svelte-mm3tjv subsection" data-level=3>0.17 to 0.18 </a> <a href=migrating#0_14_to_0_15 class="svelte-mm3tjv subsection" data-level=3>0.14 to 0.15 </a> <a href=migrating#0_13_to_0_14 class="svelte-mm3tjv subsection" data-level=3>0.13 to 0.14 </a> <a href=migrating#0_11_to_0_12 class="svelte-mm3tjv subsection" data-level=3>0.11 to 0.12 </a> <a href=migrating#0_9_to_0_10 class="svelte-mm3tjv subsection" data-level=3>&lt;0.9 to 0.10 </a> <a href=migrating#0_6_to_0_7 class="svelte-mm3tjv subsection" data-level=3>0.6 to 0.7 </a> </ul></div> <button class=svelte-1itkhys> <svg class="icon svelte-5yec89" height=20 width=20><use xlink:href=#menu></use></svg></button></aside></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,(function(a,b,c,d,e){return {sections:[{html:"\u003Cp\u003EUntil we reach version 1.0, there may be occasional changes to the project structure Sapper expects.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_27_to_0_28\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_27_to_0_28\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.27 to 0.28\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cul\u003E\n\u003Cli\u003ERollup 0.x.x is no longer supported. (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1326\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1326\u003C\u002Fa\u003E). Any version greater than 1.x is supported, but the latest (currently 2.x) is strongly recommended.\u003C\u002Fli\u003E\n\u003Cli\u003EVersions of Svelte before 3.17.3 are no longer supported. (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1067\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1067\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003E&lt;script&gt;\u003C\u002Fcode\u003E tags will now be loaded with the \u003Ccode\u003Edefer\u003C\u002Fcode\u003E attribute (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1123\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1123\u003C\u002Fa\u003E), which means:\u003Cul\u003E\n\u003Cli\u003EIE9 support was dropped since IE9 may interleave deferred script execution.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003E%sapper.scripts%\u003C\u002Fcode\u003E can be moved to the \u003Ccode\u003E&lt;head&gt;\u003C\u002Fcode\u003E section for slightly better performance\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EYou must set \u003Ccode\u003Ehydratable: true\u003C\u002Fcode\u003E in your server build as well in order to properly hydrate \u003Ccode\u003E&lt;head&gt;\u003C\u002Fcode\u003E elements (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1067\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1067\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003Cli\u003EThe files in the generated \u003Ccode\u003Eservice-worker.js\u003C\u002Fcode\u003E file are now prefixed with a \u003Ccode\u003E\u002F\u003C\u002Fcode\u003E (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1244\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1244\u003C\u002Fa\u003E). If you are using the \u003Ccode\u003Eservice-worker.js\u003C\u002Fcode\u003E from the default template, no changes will be necessary. If you have modified your service worker, please check to ensure compatibility.\u003C\u002Fli\u003E\n\u003Cli\u003EThe \u003Ccode\u003Esapper-noscroll\u003C\u002Fcode\u003E attribute was renamed to \u003Ccode\u003Esapper:noscroll\u003C\u002Fcode\u003E (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper\u002Fpull\u002F1320\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E#1320\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003Cli\u003ERollup users should update the \u003Ccode\u003Eonwarn\u003C\u002Fcode\u003E filter in \u003Ccode\u003Erollup.config.js\u003C\u002Fcode\u003E to match \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper-template\u002Fpull\u002F246\u002Ffiles\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ethe change made in \u003Ccode\u003Esapper-template\u003C\u002Fcode\u003E\u003C\u002Fa\u003E. \u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_25_to_0_26\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_25_to_0_26\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.25 to 0.26\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EThe most significant change yet: Sapper is now built on Svelte 3.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch4\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Importing_Sapper\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#Importing_Sapper\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tImporting Sapper\n\t\t\t\t\t\u003C\u002Fh4\u003E\u003Cp\u003EYour app&#39;s runtime is now built to \u003Ccode\u003Esrc\u002Fnode_modules\u002F@sapper\u003C\u002Fcode\u003E — this allows you to easily import it from anywhere in your source code. Update your \u003Ccode\u003Eserver.js\u003C\u002Fcode\u003E...\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F src\u002Fserver.js\n\u003Cspan class=\"hljs-deletion\"\u003E-import * as sapper from '..\u002F__sapper__\u002Fserver.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import * as sapper from '@sapper\u002Fserver';\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E...and client.js:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-deletion\"\u003E-import * as sapper from '..\u002F__sapper__\u002Fclient.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import * as sapper from '@sapper\u002Fapp';\u003C\u002Fspan\u003E\n\nsapper.start({\n\ttarget: document.querySelector('#sapper')\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EThe same applies to imports like \u003Ccode\u003Egoto\u003C\u002Fcode\u003E and \u003Ccode\u003EprefetchRoutes\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch4\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Webpack_config\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#Webpack_config\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tWebpack config\n\t\t\t\t\t\u003C\u002Fh4\u003E\u003Cp\u003EIf you&#39;re using webpack, you must update your configuration to recognise \u003Ccode\u003E.mjs\u003C\u002Fcode\u003E and \u003Ccode\u003E.svelte\u003C\u002Fcode\u003E files:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-javascript'\u003E\u003Ccode\u003Eresolve: {\n\t\u003Cspan class=\"hljs-attr\"\u003Eextensions\u003C\u002Fspan\u003E: [\u003Cspan class=\"hljs-string\"\u003E'.mjs'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'.js'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'.json'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'.svelte'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'.html'\u003C\u002Fspan\u003E]\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EIf you&#39;re using .svelte files (recommended), you&#39;ll also need to tell \u003Ccode\u003Esvelte-loader\u003C\u002Fcode\u003E to expect them:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-deletion\"\u003E-test: \u002F\\.html$\u002F\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+test: \u002F\\.(svelte|html)$\u002F\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\t\t\t\t\t\u003Ch4\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Session_data\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#Session_data\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tSession data\n\t\t\t\t\t\u003C\u002Fh4\u003E\u003Cp\u003EPassing data from server to client is now accomplished with a \u003Ccode\u003Esession\u003C\u002Fcode\u003E function passed to the middleware:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-javascript'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F src\u002Fserver.js\u003C\u002Fspan\u003E\nsapper.middleware({\n\t\u003Cspan class=\"hljs-attr\"\u003Esession\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Ereq, res\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E ({\n\t\t\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F session data goes here\u003C\u002Fspan\u003E\n\t})\n})\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EThis data is available in \u003Ccode\u003Epreload\u003C\u002Fcode\u003E functions as the second argument:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-markup'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-comment\"\u003E&lt;!-- SomeComponent.svelte --&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Econtext\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"module\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"javascript\"\u003E\n\t\u003Cspan class=\"hljs-keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Epreload\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003Epage, session\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n\t\t\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E { path, params, query } = page; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F as before\u003C\u002Fspan\u003E\n\n\t\t\u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (!session.user) \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.redirect(\u003Cspan class=\"hljs-number\"\u003E302\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'login'\u003C\u002Fspan\u003E);\n\t\t\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F ...\u003C\u002Fspan\u003E\n\t}\n\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\t\t\t\t\t\u003Ch4\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Stores\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#Stores\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tStores\n\t\t\t\t\t\u003C\u002Fh4\u003E\u003Cp\u003EIt is also available, along with \u003Ccode\u003Epage\u003C\u002Fcode\u003E and \u003Ccode\u003Epreloading\u003C\u002Fcode\u003E, as a store inside components:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-markup'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"javascript\"\u003E\n\t\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E * \u003Cspan class=\"hljs-keyword\"\u003Eas\u003C\u002Fspan\u003E sapper \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'@sapper\u002Fapp'\u003C\u002Fspan\u003E;\n\t\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E { page, preloading, session } = sapper.stores();\n\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E\u003Ccode\u003Epage\u003C\u002Fcode\u003E and \u003Ccode\u003Epreloading\u003C\u002Fcode\u003E are \u003Ca href=\"https:\u002F\u002Fsvelte.dev\u002Ftutorial\u002Freadable-stores\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ereadable stores\u003C\u002Fa\u003E, while \u003Ccode\u003Esession\u003C\u002Fcode\u003E is \u003Ca href=\"https:\u002F\u002Fsvelte.dev\u002Ftutorial\u002Fwritable-stores\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ewritable\u003C\u002Fa\u003E. Writing to the session store (for example, after the user logs in) will cause any \u003Ccode\u003Epreload\u003C\u002Fcode\u003E functions that rely on session data to re-run; it will not persist anything to the server.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch4\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Layouts\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#Layouts\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tLayouts\n\t\t\t\t\t\u003C\u002Fh4\u003E\u003Cp\u003EYour layout components should now use a \u003Ccode\u003E&lt;slot&gt;\u003C\u002Fcode\u003E element to render nested routes, instead of \u003Ccode\u003E&lt;svelte:component&gt;\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E&lt;main&gt;\n\u003Cspan class=\"hljs-deletion\"\u003E-    &lt;svelte:component this={child.component} {...child.props}\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+    &lt;slot&gt;&lt;\u002Fslot&gt;\u003C\u002Fspan\u003E\n&lt;\u002Fmain&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EThe layout component itself receives a \u003Ccode\u003Esegment\u003C\u002Fcode\u003E prop, which is equivalent to \u003Ccode\u003Echild.segment\u003C\u002Fcode\u003E in earlier versions.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_21_to_0_22\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_21_to_0_22\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.21 to 0.22\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EInstead of importing middleware from the \u003Ccode\u003Esapper\u003C\u002Fcode\u003E package, or importing the client runtime from \u003Ccode\u003Esapper\u002Fruntime.js\u003C\u002Fcode\u003E, the app is \u003Cem\u003Ecompiled into\u003C\u002Fem\u003E the generated files:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F src\u002Fclient.js\n\u003Cspan class=\"hljs-deletion\"\u003E-import { init } from 'sapper\u002Fruntime.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-import { manifest } from '.\u002Fmanifest\u002Fclient.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import * as sapper from '..\u002F__sapper__\u002Fclient.js';\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-deletion\"\u003E-init({\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+sapper.start({\u003C\u002Fspan\u003E\n\ttarget: document.querySelector('#sapper'),\n\u003Cspan class=\"hljs-deletion\"\u003E-    manifest\u003C\u002Fspan\u003E\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F src\u002Fserver.js\nimport sirv from 'sirv';\nimport polka from 'polka';\nimport compression from 'compression';\n\u003Cspan class=\"hljs-deletion\"\u003E-import sapper from 'sapper';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-import { manifest } from '.\u002Fmanifest\u002Fserver.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import * as sapper from '..\u002F__sapper__\u002Fserver.js';\u003C\u002Fspan\u003E\n\nconst { PORT, NODE_ENV } = process.env;\nconst dev = NODE_ENV \u003Cspan class=\"hljs-comment\"\u003E=== 'development';\u003C\u002Fspan\u003E\n\npolka() \u002F\u002F You can also use Express\n\t.use(\n\t\tcompression({ threshold: 0 }),\n\u003Cspan class=\"hljs-deletion\"\u003E-        sirv('assets', { dev }),\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+        sirv('static', { dev }),\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-        sapper({ manifest })\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+        sapper.middleware()\u003C\u002Fspan\u003E\n\t)\n\t.listen(PORT, err =&gt; {\n\t\tif (err) console.log('error', err);\n\t});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F src\u002Fservice-worker.js\n\u003Cspan class=\"hljs-deletion\"\u003E-import { assets, shell, routes, timestamp } from '.\u002Fmanifest\u002Fservice-worker.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import { files, shell, routes, timestamp } from '..\u002F__sapper__\u002Fservice-worker.js';\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EIn addition, the default build and export directories are now \u003Ccode\u003E__sapper__\u002Fbuild\u003C\u002Fcode\u003E and \u003Ccode\u003E__sapper__\u002Fexport\u003C\u002Fcode\u003E respectively.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_20_to_0_21\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_20_to_0_21\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.20 to 0.21\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cul\u003E\n\u003Cli\u003EThe \u003Ccode\u003Eapp\u003C\u002Fcode\u003E directory is now \u003Ccode\u003Esrc\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EThe \u003Ccode\u003Eroutes\u003C\u002Fcode\u003E directory is now \u003Ccode\u003Esrc\u002Froutes\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EThe \u003Ccode\u003Eassets\u003C\u002Fcode\u003E directory is now \u003Ccode\u003Estatic\u003C\u002Fcode\u003E (remember to update your \u003Ccode\u003Esrc\u002Fserver.js\u003C\u002Fcode\u003E file to reflect this change as well)\u003C\u002Fli\u003E\n\u003Cli\u003EInstead of having three separate config files (\u003Ccode\u003Ewebpack\u002Fclient.config.js\u003C\u002Fcode\u003E, \u003Ccode\u003Ewebpack\u002Fserver.config.js\u003C\u002Fcode\u003E and \u003Ccode\u003Ewebpack\u002Fservice-worker.config.js\u003C\u002Fcode\u003E), there is a single \u003Ccode\u003Ewebpack.config.js\u003C\u002Fcode\u003E file that exports \u003Ccode\u003Eclient\u003C\u002Fcode\u003E, \u003Ccode\u003Eserver\u003C\u002Fcode\u003E and \u003Ccode\u003Eserviceworker\u003C\u002Fcode\u003E configs.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_17_to_0_18\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_17_to_0_18\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.17 to 0.18\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EThe \u003Ccode\u003Esapper\u002Fwebpack\u002Fconfig.js\u003C\u002Fcode\u003E file (required in the \u003Ccode\u003Ewebpack\u002F*.config.js\u003C\u002Fcode\u003E files) is now \u003Ccode\u003Esapper\u002Fconfig\u002Fwebpack.js\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_14_to_0_15\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_14_to_0_15\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.14 to 0.15\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EThis release changed how routing is handled, resulting in a number of changes.\u003C\u002Fp\u003E\n\u003Cp\u003EInstead of a single \u003Ccode\u003EApp.html\u003C\u002Fcode\u003E component, you can place \u003Ccode\u003E_layout.html\u003C\u002Fcode\u003E components in any directory under \u003Ccode\u003Eroutes\u003C\u002Fcode\u003E. You should move \u003Ccode\u003Eapp\u002FApp.html\u003C\u002Fcode\u003E to \u003Ccode\u003Eroutes\u002F_layout.html\u003C\u002Fcode\u003E and modify it like so:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-deletion\"\u003E-&lt;!-- app\u002FApp.html --&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+&lt;!-- routes\u002F_layout.html --&gt;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-deletion\"\u003E-&lt;Nav path={props.path}\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+&lt;Nav segment={child.segment}\u002F&gt;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-deletion\"\u003E-&lt;svelte:component this={Page} {...props}\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+&lt;svelte:component this={child.component} {...child.props}\u002F&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EYou will then need to remove \u003Ccode\u003EApp\u003C\u002Fcode\u003E from your client and server entry points, and replace \u003Ccode\u003Eroutes\u003C\u002Fcode\u003E with \u003Ccode\u003Emanifest\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F app\u002Fclient.js\nimport { init } from 'sapper\u002Fruntime.js';\n\u003Cspan class=\"hljs-deletion\"\u003E-import { routes } from '.\u002Fmanifest\u002Fclient.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-import App from '.\u002FApp.html';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import { manifest } from '.\u002Fmanifest\u002Fclient.js';\u003C\u002Fspan\u003E\n\ninit({\n\ttarget: document.querySelector('#sapper'),\n\u003Cspan class=\"hljs-deletion\"\u003E-    routes,\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-    App\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+    manifest\u003C\u002Fspan\u003E\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F app\u002Fserver.js\nimport sirv from 'sirv';\nimport polka from 'polka';\nimport sapper from 'sapper';\nimport compression from 'compression';\n\u003Cspan class=\"hljs-deletion\"\u003E-import { routes } from '.\u002Fmanifest\u002Fserver.js';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-deletion\"\u003E-import App from '.\u002FApp.html';\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+import { manifest } from '.\u002Fmanifest\u002Fserver.js';\u003C\u002Fspan\u003E\n\npolka()\n\t.use(\n\t\tcompression({ threshold: 0 }),\n\t\tsirv('assets'),\n\u003Cspan class=\"hljs-deletion\"\u003E-        sapper({ routes, App })\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+        sapper({ manifest })\u003C\u002Fspan\u003E\n\t)\n\t.listen(process.env.PORT)\n\t.catch(err =&gt; {\n\t\tconsole.log('error', err);\n\t});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E\u003Ccode\u003Epreload\u003C\u002Fcode\u003E functions no longer take the entire request object on the server; instead, they receive the same argument as on the client.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_13_to_0_14\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_13_to_0_14\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.13 to 0.14\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EThe \u003Ccode\u003E4xx.html\u003C\u002Fcode\u003E and \u003Ccode\u003E5xx.html\u003C\u002Fcode\u003E error pages have been replaced with a single page, \u003Ccode\u003E_error.html\u003C\u002Fcode\u003E. In addition to the regular \u003Ccode\u003Eparams\u003C\u002Fcode\u003E, \u003Ccode\u003Equery\u003C\u002Fcode\u003E and \u003Ccode\u003Epath\u003C\u002Fcode\u003E props, it receives \u003Ccode\u003Estatus\u003C\u002Fcode\u003E and \u003Ccode\u003Eerror\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_11_to_0_12\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_11_to_0_12\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.11 to 0.12\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EIn earlier versions, each page was a completely standalone component. Upon navigation, the entire page would be torn down and a new one created. Typically, each page would import a shared \u003Ccode\u003E&lt;Layout&gt;\u003C\u002Fcode\u003E component to achieve visual consistency.\u003C\u002Fp\u003E\n\u003Cp\u003EAs of 0.12, this changes: we have a single \u003Ccode\u003E&lt;App&gt;\u003C\u002Fcode\u003E component, defined in \u003Ccode\u003Eapp\u002FApp.html\u003C\u002Fcode\u003E, which controls the rendering of the rest of the app. See \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper-template\u002Fblob\u002Fmaster\u002Fapp\u002FApp.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Esapper-template\u003C\u002Fa\u003E for an example.\u003C\u002Fp\u003E\n\u003Cp\u003EThis component is rendered with the following values:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EPage\u003C\u002Fcode\u003E — a component constructor for the current page\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eprops\u003C\u002Fcode\u003E — an object with \u003Ccode\u003Eparams\u003C\u002Fcode\u003E, \u003Ccode\u003Equery\u003C\u002Fcode\u003E, and any data returned from the page&#39;s \u003Ccode\u003Epreload\u003C\u002Fcode\u003E function\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Epreloading\u003C\u002Fcode\u003E — \u003Ccode\u003Etrue\u003C\u002Fcode\u003E during preload, \u003Ccode\u003Efalse\u003C\u002Fcode\u003E otherwise. Useful for showing progress indicators\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ESapper needs to know about your app component. To that end, you will need to modify your \u003Ccode\u003Eapp\u002Fserver.js\u003C\u002Fcode\u003E and \u003Ccode\u003Eapp\u002Fclient.js\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F app\u002Fserver.js\nimport polka from 'polka';\nimport sapper from 'sapper';\nimport serve from 'serve-static';\nimport { routes } from '.\u002Fmanifest\u002Fserver.js';\n\u003Cspan class=\"hljs-addition\"\u003E+import App from '.\u002FApp.html';\u003C\u002Fspan\u003E\n\npolka()\n\t.use(\n\t\tserve('assets'),\n\u003Cspan class=\"hljs-deletion\"\u003E-        sapper({ routes })\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+        sapper({ App, routes })\u003C\u002Fspan\u003E\n\t)\n\t.listen(process.env.PORT);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-diff'\u003E\u003Ccode\u003E\u002F\u002F app\u002Fclient.js\nimport { init } from 'sapper\u002Fruntime.js';\nimport { routes } from '.\u002Fmanifest\u002Fclient.js';\n\u003Cspan class=\"hljs-addition\"\u003E+import App from '.\u002FApp.html';\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-deletion\"\u003E-init(target: document.querySelector('#sapper'), routes);\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+init({\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+    target: document.querySelector('#sapper'),\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+    routes,\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+    App\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-addition\"\u003E+});\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EOnce your \u003Ccode\u003EApp.html\u003C\u002Fcode\u003E has been created and your server and client apps updated, you can remove any \u003Ccode\u003E&lt;Layout&gt;\u003C\u002Fcode\u003E components from your individual pages.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_9_to_0_10\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_9_to_0_10\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t&lt;0.9 to 0.10\n\t\t\t\t\t\u003C\u002Fh3\u003E\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tapp\u002Ftemplate.html\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cul\u003E\n\u003Cli\u003EYour \u003Ccode\u003E&lt;head&gt;\u003C\u002Fcode\u003E element must contain \u003Ccode\u003E%sapper.base%\u003C\u002Fcode\u003E (see (\u003Ca href=\"docs#Base_URLs\" rel=\"noopener noreferrer\"\u003Ebase URLs\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003Cli\u003ERemove references to your service worker; this is now handled by \u003Ccode\u003E%sapper.scripts%\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tPages\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cul\u003E\n\u003Cli\u003EYour \u003Ccode\u003Epreload\u003C\u002Fcode\u003E functions should now use \u003Ccode\u003Ethis.fetch\u003C\u002Fcode\u003E instead of \u003Ccode\u003Efetch\u003C\u002Fcode\u003E. \u003Ccode\u003Ethis.fetch\u003C\u002Fcode\u003E allows you to make credentialled requests on the server, and means that you no longer need to create a \u003Ccode\u003Eglobal.fetch\u003C\u002Fcode\u003E object in \u003Ccode\u003Eapp\u002Fserver.js\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"0_6_to_0_7\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#0_6_to_0_7\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\t0.6 to 0.7\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EConsult \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper-template\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Esapper-template\u003C\u002Fa\u003E for full examples of all the below points.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tpackage.json\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cp\u003ETo start a dev server, use \u003Ccode\u003Esapper dev\u003C\u002Fcode\u003E rather than \u003Ccode\u003Enode server.js\u003C\u002Fcode\u003E. In all likelihood, your package.json will have an \u003Ccode\u003Enpm run dev\u003C\u002Fcode\u003E script that will need to be updated.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tEntry points\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cp\u003EAs of version 0.7, Sapper expects to find your entry points — for client, server and service worker — in an \u003Ccode\u003Eapp\u003C\u002Fcode\u003E folder. Instead of using magically-injected \u003Ccode\u003E__variables__\u003C\u002Fcode\u003E, each entry point imports from its corresponding file in the \u003Ccode\u003Eapp\u002Fmanifests\u003C\u002Fcode\u003E folder. These are automatically generated by Sapper.\u003C\u002Fp\u003E\n\u003Cdiv class=''\u003E\u003Cpre class='language-javascript'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F app\u002Fclient.js (formerly templates\u002Fmain.js)\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E { init } \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'sapper\u002Fruntime.js'\u003C\u002Fspan\u003E;\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E { routes } \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'.\u002Fmanifest\u002Fclient.js'\u003C\u002Fspan\u003E;\n\ninit(\u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.querySelector(\u003Cspan class=\"hljs-string\"\u003E'#sapper'\u003C\u002Fspan\u003E), routes);\n\n\u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-built_in\"\u003Emodule\u003C\u002Fspan\u003E.hot) \u003Cspan class=\"hljs-built_in\"\u003Emodule\u003C\u002Fspan\u003E.hot.accept(); \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F enable hot reloading\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-javascript'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F app\u002Fserver.js (formerly server.js)\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F Note that we're now using ES module syntax, because this\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F file is processed by webpack like the rest of your app\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E sapper \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'sapper'\u003C\u002Fspan\u003E;\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E { routes } \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'.\u002Fmanifest\u002Fserver.js'\u003C\u002Fspan\u003E;\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F ..other imports\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F we now pass the `routes` object to the Sapper middleware\u003C\u002Fspan\u003E\napp.use(sapper({\n\troutes\n}));\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=''\u003E\u003Cpre class='language-javascript'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F app\u002Fservice-worker.js (formerly templates\u002Fservice-worker.js)\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E { assets, shell, timestamp, routes } \u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'.\u002Fmanifest\u002Fservice-worker.js'\u003C\u002Fspan\u003E;\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F replace e.g. `__assets__` with `assets` in the rest of the file\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tTemplates and error pages\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cp\u003EIn previous versions, we had \u003Ccode\u003Etemplates\u002F2xx.html\u003C\u002Fcode\u003E, \u003Ccode\u003Etemplates\u002F4xx.html\u003C\u002Fcode\u003E and \u003Ccode\u003Etemplates\u002F5xx.html\u003C\u002Fcode\u003E. Now, we have a single template, \u003Ccode\u003Eapp\u002Ftemplate.html\u003C\u002Fcode\u003E, which should look like your old \u003Ccode\u003Etemplates\u002F2xx.html\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EFor handling error states, we have a &#39;special&#39; route: \u003Ccode\u003Eroutes\u002F_error.html\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EThis page is just like any other, except that it will get rendered whenever an error states is reached. The component has access to \u003Ccode\u003Estatus\u003C\u002Fcode\u003E and \u003Ccode\u003Eerror\u003C\u002Fcode\u003E values.\u003C\u002Fp\u003E\n\u003Cp\u003ENote that you can now use \u003Ccode\u003Ethis.error(statusCode, error)\u003C\u002Fcode\u003E inside your \u003Ccode\u003Epreload\u003C\u002Fcode\u003E functions.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch5\u003E\n\t\t\t\t\t\t\u003Cspan id=\"false\" class=\"offset-anchor\" data-scrollignore\u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"migrating#false\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tWebpack configs\n\t\t\t\t\t\u003C\u002Fh5\u003E\u003Cp\u003EYour webpack configs now live in a \u003Ccode\u003Ewebpack\u003C\u002Fcode\u003E directory:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Ewebpack.client.config.js\u003C\u002Fcode\u003E is now \u003Ccode\u003Ewebpack\u002Fclient.config.js\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Ewebpack.server.config.js\u003C\u002Fcode\u003E is now \u003Ccode\u003Ewebpack\u002Fserver.config.js\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EIf you have a service worker, you should also have a \u003Ccode\u003Ewebpack\u002Fservice-worker.config.js\u003C\u002Fcode\u003E file. See \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fsapper-template\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Esapper-template\u003C\u002Fa\u003E for an example.\u003C\u002Fp\u003E\n",metadata:{title:c},subsections:[{slug:"0_27_to_0_28",title:"0.27 to 0.28",level:a},{slug:"0_25_to_0_26",title:"0.25 to 0.26",level:a},{slug:"Importing_Sapper",title:"Importing Sapper",level:b},{slug:"Webpack_config",title:"Webpack config",level:b},{slug:"Session_data",title:"Session data",level:b},{slug:d,title:d,level:b},{slug:e,title:e,level:b},{slug:"0_21_to_0_22",title:"0.21 to 0.22",level:a},{slug:"0_20_to_0_21",title:"0.20 to 0.21",level:a},{slug:"0_17_to_0_18",title:"0.17 to 0.18",level:a},{slug:"0_14_to_0_15",title:"0.14 to 0.15",level:a},{slug:"0_13_to_0_14",title:"0.13 to 0.14",level:a},{slug:"0_11_to_0_12",title:"0.11 to 0.12",level:a},{slug:"0_9_to_0_10",title:"&lt;0.9 to 0.10",level:a},{slug:"0_6_to_0_7",title:"0.6 to 0.7",level:a}],slug:c,file:"01-migrating.md"}]}}(3,4,"Migrating","Stores","Layouts"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.141aceb2.js"}catch(e){main="/client/legacy/client.5ee277ff.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 